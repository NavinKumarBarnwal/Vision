<!DOCTYPE html>
<html lang="zxx">

<head>
{% load static %}
    <meta charset="UTF-8">
    <meta name="description" content="Fashi Template">
    <meta name="keywords" content="Fashi, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Vision</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&display=swap" rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/themify-icons.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/elegant-icons.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/nice-select.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/slicknav.min.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css">
     <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh'}" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
   </head>
   <style>
    .w3-container {
        margin:10px;
        margin-top: 10%;
        padding: 5px 30px;
        color:cyan;
        font-size: 20px;
        border:cyan;
        padding:0.05em 25px}

    
    .a{
        font-size: 15px;
        color: olivedrab;
    }
    .b{
        color: #00FF00;
        font-size: 20px;
    }
    .c{
        color:#00FF00;
        font-size: 19px;
        padding: 5px;
        margin: 30px;
        border: 2px solid #00FF00;
    }
    .w3-modal{
        z-index:3;
        display:none;
        padding-top:100px;
        position:fixed;
        left:0;
        top:0;
        width:100%;
        height:100%;
        overflow:auto;
        background-color:rgba(0, 1, 0, 0.1);
        
    }
    .w3-modal-content{
        margin:auto;
        background: black;
        position:relative;
        padding:0;
        outline:0;
        width:50%;
        text-align: center;
        border: 2px solid #00FF00;
    }

</style>
<body>
    <!-- Page Preloder --> 
    <div id="preloder">
        <div class="loader"></div>
    </div>
    <div id="id01" class="w3-modal">
        <div class="w3-modal-content">
          <div class="w3-container">
            <span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-display-topright">&times;</span>
              <form enctype="multipart/form-data" id="id_ajax_upload_form" method="POST" novalidate="">
          {% csrf_token %}
          {{ form.as_p }}
          <input type="submit" />
      </form>
      
          <!--  <p class="c"><strong class="b">Note:</strong> Only .pdf and .docx formats are acceptable.</p>
            <p class="a"><a href="{% url 'home' %}">Return to home</a></p>-->
          </div>
        </div>
      </div>
    <!--Chatbot-->
  <div class="back" style="background-color:rgb(69, 223, 223)">
    <div id="chat1">
      <button class="open-button" onclick="openForm()" style="background-color: #0309a8;
      color: white;
      padding: 16px 20px;
      border: none;
      cursor: pointer;
      opacity: 0.8;
      position: fixed;
      bottom: 23px;
      right: 28px;
      width: 280px;
      z-index:100;">Vision bot</button>
    </div> 
   

    <div class="chat-popup" id="myForm" style="display: none;
             position: fixed;
             bottom:450px;
             right: 28px;
             width:280px;
             z-index:9;
             background-color:rgb(69, 223, 223);
             border:10px solid rgb(69, 223, 223);
             border-radius:5px;">
            <!--<p class="msg-header" style="bottom:500px; 
            right:30px; height:150px; 
            width:280px;text-align:centre;
            ">-->

            <h6><b>Vision Bot</b></h6>
            <h6>Active Now</h6>

<!--<div class="header-icons">
<i class="fa fa-phone"></i>
<i class="fa fa-video-camera"></i>
<i class="fa fa-info-circle"></i>
</div>--> 
{% if user.is_authenticated %}    
         <div  class="chat-title" id="chatLog" style="background-color:rgb(244, 252, 244);
      color:black;
      padding:10px 10px;
      border:thick solid rgb(69, 223, 223);
      cursor:pointer;
      opacity: 1;
      position: fixed;
      bottom: 160px;
      right: 28px;
      width: 280px; z-index:150;
      overflow-y:auto;
      overflow-x:hidden;
      height:295px;">
      <b>Vision Bot: </b>Hi {{user.username}}! I am Vision Bot.<br>
         </div>
         <div class="form-container" style="position: fixed;
      bottom:100px;
      right:28px;
      height:65px;
      width:280px;
      padding: 10px 10px;
      border-radius:7px;
      background-color:rgb(62,223,223); z-index:150; border-radius:7px">
            <div>   

            <input  placeholder="Type msg & press enter" id="userBox" style="float:left; padding: 5px 5px;justify-content:space-between;width:200px; border-radius:5px;" type="text" onkeydown="if (event.keyCode == 13) {talk(); updateScroll()}" >
            <span><i onclick="record()" class="fa fa-microphone" style="background-color: #555;
                color: white;
                padding: 11px 10px;
                border: none;
                cursor: pointer;
                opacity: 1;
                position: fixed;
                right: 68px;
                z-index:300;border-radius:5px;"></i></span>
                <span><i onclick="document.getElementById('id01').style.display='block'" class="fa fa-picture-o" style="background-color: #555;
                    color: white;
                    padding: 11px 9px;
                    border: none;
                    cursor: pointer;
                    opacity: 1;
                    position: fixed;
                    right: 31px;
                    z-index:300;border-radius:5px;"></i></span>
                 
     <!--<form action="/action_page.php" method="post" class="form-container"-->
        
            </div>                     <!--<label for="msg"><b>Message</b></label>-->
             
             <!--<button onclick="record()"><i class="fa fa-microphone" style="font-size:24px;float:right;"></i></button>-->
             
         </div>
         
         <i type="button" onclick="closeForm()" class="fa fa-close" style="background-color: #555;
            color: white;
            padding: 16px 20px;
            border: none;
            cursor: pointer;
            opacity: 1;
            position: fixed;
            bottom: 477px;
            right: 28px;
            width: 50px;
            z-index:300;"></i>

      {% else %}
      <div>
      <p class="chat-title" id="chatLog" style="background-color:rgb(244, 252, 248);
      color:black;
      padding:10px 10px;
      border:thick solid rgb(69, 223, 223);
      cursor:pointer;
      opacity: 1;
      position: fixed;
      bottom: 59px;
      right: 28px;
      width: 280px; z-index:150;
      overflow-y:auto;
      overflow-x:hidden;
      height:500px;
      border-radius:7px;">
      <!--<b>Vision Bot:</b> Please Login to Conversate.<br>--></p>
      
         </div>
         <i type="button" onclick="closeForm()" class="fa fa-close" style="background-color: #555;
            color: white;
            padding: 16px 20px;
            border: none;
            cursor: pointer;
            opacity: 1;
            position: fixed;
            bottom: 527px;
            right: 28px;
            width: 50px;
            z-index:300;"></i>
         {% endif %}
         
        </div>
    </div>       

    
<!-- Header Section Begin -->
<header class="header-section">
    <div class="header-top">
        <div class="container">
            <div class="ht-left">
                <div class="mail-service">
                    <i class=" fa fa-envelope"></i>
                    hello@gmail.com
                </div>
                <div class="phone-service">
                    <i class=" fa fa-phone"></i>
                    +188888
                </div>
            </div>
            <div class="ht-right">
                {% if not user.is_authenticated %}
                    <a href="/" class="login-panel"><i class="fa fa-user"> Register</i></a>
                    <a href="/" class="login-panel"><i class="fa fa-user"> Login</i></a>
                {% else %}
                    <h3 class="login-panel">Hi, {{user.username}}</h3>
                    <a href="/" class="login-panel"><i class="fa fa-user"> Log Out</i></a>
                {% endif %}
                <div class="lan-selector">
                    <select class="language_drop" name="countries" id="countries" style="width:300px;">
                        <option value='yt' data-image="{% static 'img/flag-1.jpg' %}" data-imagecss="flag yt"
                            data-title="English">English</option>
                        <option value='yu' data-image="{% static 'img/flag-2.jpg' %}" data-imagecss="flag yu"
                            data-title="Indian">Indian </option>
                    </select>
                </div>
                <div class="top-social">
                    <a href="#"><i class="ti-facebook"></i></a>
                    <a href="#"><i class="ti-twitter-alt"></i></a>
                    <a href="#"><i class="ti-linkedin"></i></a>
                    <a href="#"><i class="ti-pinterest"></i></a>
                </div>
            </div>
        </div>
    </div>
    <div class="nav-item">
        <div class="container">
            
            <nav class="nav-menu mobile-menu">
                <ul>
                   <li> <h3 style="color:rgb(69, 223, 223)";>*************************************************************************************</h3></li>
                    
                </ul>
            </nav>
            <div id="mobile-menu-wrap"></div>
        </div>
    </div>
</header>
<!-- Header End -->
    {% block body %}
    {% endblock %}

<!-- Partner Logo Section Begin -->
<div class="partner-logo">
    <div class="container">
        <div class="logo-carousel owl-carousel">
            <div class="logo-item">
                <div class="tablecell-inner">
                    <img src="{% static 'img/logo-carousel/logo-1.png' %}" alt="">
                </div>
            </div>
            <div class="logo-item">
                <div class="tablecell-inner">
                    <img src="{% static 'img/logo-carousel/logo-2.png' %}" alt="">
                </div>
            </div>
            <div class="logo-item">
                <div class="tablecell-inner">
                    <img src="{% static 'img/logo-carousel/logo-3.png' %}" alt="">
                </div>
            </div>
            <div class="logo-item">
                <div class="tablecell-inner">
                    <img src="{% static 'img/logo-carousel/logo-4.png' %}" alt="">
                </div>
            </div>
            <div class="logo-item">
                <div class="tablecell-inner">
                    <img src="{% static 'img/logo-carousel/logo-5.png' %}" alt="">
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Partner Logo Section End -->

    

<!-- Footer Section Begin -->
<footer class="footer-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="footer-left">
                    <div class="footer-logo">
                        <a href="#"></a>
                    </div>
                    <ul>
                        <li>Address: NIT Rourkela</li>
                        <li>Phone: +1188888</li>
                        <li>Email: hello@gmail.com</li>
                    </ul>
                    <div class="footer-social">
                        <a href="#"><i class="fa fa-facebook"></i></a>
                        <a href="#"><i class="fa fa-instagram"></i></a>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                        <a href="#"><i class="fa fa-pinterest"></i></a>
                    </div>
                </div>
            </div>
            <div class="col-lg-2 offset-lg-1">
                <div class="footer-widget">
                    <h5>Information</h5>
                    <ul>
                        <li><a href="#">About Us</a></li>
                    </ul>
                </div>
            </div>
            
        </div>
    </div>
    <div class="copyright-reserved">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="copyright-text">
    Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved |<i aria-hidden="true"></i> by Vision

                    </div>
                    <div class="payment-pic">
                        <img src="{% static 'img/payment-method.png' %}" alt="">
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- Footer Section End -->

<!-- Js Plugins -->
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script>
    document.getElementById("chatLog").innerHTML=localStorage.getItem("key");
    var voiceList;//=document.querySelector('#voiceList');
    var synth = window.speechSynthesis;
    var voices = [];
    PopulateVoices();
    if(speechSynthesis !== undefined)
    {
        speechSynthesis.onvoiceschanged = PopulateVoices;
    }
    var toSpeak;
    function record()
    {
        var recognition = new webkitSpeechRecognition();
        recognition.lang = "en-IN";
        //recognion.continuous=true;
        //recognion.interimResults = true;
        recognition.onresult = function(event)
        {
            // console.log(event);
            document.getElementById('userBox').value = event.results[0][0].transcript;
            var user = document.getElementById("userBox").value;
            user = user.replace('card','cart');
            //document.getElementById("chatLog").innerHTML += user+"<br>";
            //document.getElementById("userBox").value = "";
            var url = '/send?name='+user;
            var req = new XMLHttpRequest();
            var t;
            var User="{{user.username}}";
            User = User.charAt(0).toUpperCase() + User.substring(1);
            User=User.bold()+": ".bold()
            var Visi="Vision Bot: ".bold()
            req.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                t=req.responseText;
                
                if (t.charAt(0)=="h" && t.charAt(1)=="t" && t.charAt(2)=="t" && t.charAt(3)=="p") {
                    document.getElementById("userBox").value = "";
                    document.getElementById("chatLog").innerHTML += User+user+"<br>";
                    //document.write(t);
                    document.getElementById("chatLog").innerHTML += Visi+'<a href=" '+t+' " target="_blank">Click here for Search Query Results/View your Cart</a>'+"<br>";
                    toSpeak = new SpeechSynthesisUtterance("Click here for Search Query Results/View your Cart");
                }
                else{
                    document.getElementById("userBox").value = "";
                    document.getElementById("chatLog").innerHTML += User+user+"<br>";
                    document.getElementById("chatLog").innerHTML += Visi+t+"<br>";
                    toSpeak = new SpeechSynthesisUtterance(t);
                    
                }
                $(document).ready(function(){
                    var $text= $('#chatLog');
                    $text.scrollTop($text[0].scrollHeight);
                })
                var selectedVoiceName = voiceList;//.selectedOptions[0].getAttribute('data-name');
            voices.forEach((voice)=>
            {
                if(voice.name === selectedVoiceName)
                {
                    toSpeak.voice = voice;
                }
            });
            synth.speak(toSpeak);
            
            }
            };
            req.open("GET", url, true);
            req.send();
                    /*
            if(user in know)
            {
                toSpeak = new SpeechSynthesisUtterance(know[user]);
                document.getElementById("chatLog").innerHTML += know[user]+"<br>";
            }
            else
            {
                toSpeak = new SpeechSynthesisUtterance("I don't understand");
                document.getElementById("chatLog").innerHTML += "I don't understand...<br>";
            }
            */
            
        }
        recognition.start();
        localStorage.setItem("key",document.getElementById("chatLog").innerHTML);
    }
    
    function PopulateVoices()
    {
        voices = synth.getVoices();
        var derangedVoice = voices.filter(function (voice) {
            return voice.name == 'Deranged';
        })[0];
        voiceList.innerHTML = '';
        voices.forEach((voice)=>{
            var listItem = document.createElement('option');
            listItem.textContent = voice.name;
            listItem.setAttribute('data-lang', voice.lang);
            listItem.setAttribute('data-name', voice.name);
            voiceList.appendChild(listItem);
        });
        voiceList = derangedVoice;
    }

function talk() {
    var user = document.getElementById("userBox").value;
    var url = '/send?name='+user;
    var req = new XMLHttpRequest();
    var t;
    var User="{{user.username}}";
    User = User.charAt(0).toUpperCase() + User.substring(1);
    User=User.bold()+": ".bold()
    //var User="User: ".bold()
    var Visi="Vision Bot: ".bold()
    req.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        t=req.responseText;
        
        if (t.charAt(0)=="h" && t.charAt(1)=="t" && t.charAt(2)=="t" && t.charAt(3)=="p") {
            document.getElementById("userBox").value = "";
            document.getElementById("chatLog").innerHTML += User+user+"<br>";
            //document.write(t);
            document.getElementById("chatLog").innerHTML += Visi+'<a href=" '+t+' " target="_blank">Click here for Search Query Results/View your Cart</a>'+"<br>";
        }
        else{
            document.getElementById("userBox").value = "";
            document.getElementById("chatLog").innerHTML += User+user+"<br>";
            document.getElementById("chatLog").innerHTML += Visi+t+"<br>";
        }
        $(document).ready(function(){
            var $text= $('#chatLog');
            $text.scrollTop($text[0].scrollHeight);
        })
    }
    };
    req.open("GET", url, true);
    req.send();
    localStorage.setItem("key",document.getElementById("chatLog").innerHTML);
} 

</script>
<!-- Js Plugins -->
<script>
function openForm() {
document.getElementById("myForm").style.display = "block";
}

function closeForm() {
document.getElementById("myForm").style.display = "none";
}
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
   <script type="text/javascript">
    // form upload
    $('#id_ajax_upload_form').submit(function(e){
        e.preventDefault();
        $form = $(this)
        var formData = new FormData(this);
        $.ajax({
            url: '/send/',
            type: 'POST',
            data: formData,
            success: function (response) {
                $('.error').remove();
                console.log(response)
                if(response.error){
                    
                    $.each(response.error, function(name, error){
                        error = '<small class="text-muted error">' + error + '</small>'
                        $form.find('[name=' + name + ']').after(error);
                    })
                }
                else{
                    var x = document.createElement("IMG");
                    x.setAttribute("src", response.form);
                    x.setAttribute("width", "130");
                    x.setAttribute("height", "100");
                    x.setAttribute("alt", "The Pulpit Rock");
                    var User="{{user.username}}";
                    User = User.charAt(0).toUpperCase() + User.substring(1);
                    User=User.bold()+": ".bold()
                    document.getElementById('chatLog').innerHTML+=User;
                    document.getElementById('chatLog').innerHTML+="<br>";
                    document.getElementById('chatLog').appendChild(x);
                    document.getElementById('chatLog').innerHTML+="<br>";
                    document.getElementById('chatLog').innerHTML+="Vision Bot :".bold()+'<a href=" '+response.yu+' " target="_blank">Click here for Search Query Results/View your Cart</a>'+"<br>";
                    updateScroll();
                    //document.body.appendChild(x);
                    //alert(response.form);
                    //alert(response.message)
                    //window.location = ""
                }
            },
            cache: false,
            contentType: false,
            processData: false
        });
    });
    // end
   </script>
<script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/jquery-ui.min.js' %}"></script>
<script src="{% static 'js/jquery.countdown.min.js' %}"></script>
<script src="{% static 'js/jquery.nice-select.min.js' %}"></script>
<script src="{% static 'js/jquery.zoom.min.js' %}"></script>
<script src="{% static 'js/jquery.dd.min.js' %}"></script>
<script src="{% static 'js/jquery.slicknav.js' %}"></script>
<script src="{% static 'js/owl.carousel.min.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>



</body>
   </html>
